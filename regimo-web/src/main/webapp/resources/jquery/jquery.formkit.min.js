/*
 * Formkit jQuery plugin
 * serialize/deserialize form
 *
 * @website https://github.com/Polonious/jquery-formkit/
 * @author: Ted Liang <tedliang[dot]email[at]gmail[dot]com>
 * @version 1.1
 *
 * Licensed under the MIT License
 */
(function(c){var d={format:"object",traditional:!1,ignore:":submit, :reset, :image, :file",extractForm:"extractForm",fillForm:"fillForm",copyForm:"copyForm",resetForm:"resetForm",extractField:"extractField",fillField:"fillField"},j=c("script[data-formkit-config]").first().attr("data-formkit-config");j&&c.extend(d,eval("({"+j+"})"));c.fn[d.extractForm]=function(a){"string"==typeof a?a={format:a}:c.isFunction(a)&&(a="array"==d.format?{buildArray:a}:{buildObject:a});a=c.extend({},h,d,a||{});if("array"==
a.format)return f.toArray(f.enabledElements(this),a.buildArray);var b=f.toObject(f.enabledElements(this),a.buildObject);return"query"==a.format?c.param(b,a.traditional):b};c.fn[d.fillForm]=function(a){if("string"==typeof a)var b,a=l(c.map(a.split("&"),function(a){b=a.split("=");return{name:decodeURIComponent(b[0]),value:decodeURIComponent(b[1].replace(o,"%20"))}}));else c.isArray(a)&&(a=l(a));return f.fromObject(f.elements(this),a)};c.fn[d.copyForm]=function(a){return(!a||"string"==typeof a?c(a):
a)[d.fillForm](this[d.extractForm]())};c.fn[d.resetForm]=function(){this.each(function(){this.reset()});return this};c.fn[d.extractField]=function(a){if(a)return f.toObject(f.enabledElements(this,a),h.buildObject)[a];var a=this[d.extractForm](),b=0,c;for(k in a)a.hasOwnProperty(k)&&(c=k,b++);switch(b){case 0:break;case 1:return a[c];default:return a}};c.fn[d.fillField]=function(a,b){if(void 0==b){if(0==this.length)return c();b=a;a=this[0].name}var g={};g[a]=b;return f.fromObject(f.elements(this,!1,
a),g)};var h={buildObject:function(a,b){var g=this.name,e=b[g];"number"==typeof a&&(a=a.toString());"string"==typeof e?b[g]=[e,a]:c.isArray(e)?e.push(a):b[g]=a},buildArray:function(a){return{name:this.name,value:a}}},l=function(a){var b={};c.each(a,function(){h.buildObject.call(this,this.value,b)});return b},m=/^(radio|checkbox)$/i,n=/\r?\n/g,o=/\+/g,f={toObject:function(a,b){var c={};a.each(function(){var a=i.toObject(this);null!==a&&b.call(this,a,c)});return c},fromObject:function(a,b){return a.filter(function(){return i.fromObject(this,
b[this.name])})},toArray:function(a,b){return a.map(function(a,e){var d=i.toObject(e);return null==d?null:c.isArray(d)?c.map(d,function(a){return b.call(e,a.replace(n,"\r\n"))}):b.call(e,d.replace(n,"\r\n"))}).get()},elements:function(a,b,g){if(0==a.length)return c([]);var e=":input[name"+(g?"='"+g+"'":"")+"]",a=a[0].elements?c(c.makeArray(a[0].elements)).filter(e):a.map(function(){var a=c(this);return a.is(e)?this:a.find(e).get()});b&&(a=a.not("[disabled]"));return a.not(d.ignore)},enabledElements:function(a,
b){return f.elements(a,!0,b)}},i={toObject:function(a){var b=null;m.test(a.type)?a.checked&&(b=a.value):b=c(a).val();return b},fromObject:function(a,b){if(!(void 0==b||null===b)){var d=c(a);if(m.test(a.type)){var e=a.value==b||c.isArray(b)&&(-1!=c.inArray(a.value,b)||-1!=c.inArray(parseFloat(a.value),b));if(d.prop("checked")!=e)return d.prop("checked",e),!0}else if(d.val()!=b)return d.val(b),!0}}}})(jQuery);